<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"
  integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<nav id="navbar" class="navbar is-primary" style="background: hsl(var(--base, 0), 0%, 12%); box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3); border-bottom: 1px solid rgba(255, 255, 255, 0.08);">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="/home" style="font-weight: 600; font-size: 1.1rem; padding: 1rem 1.5rem;">
        <span style="color: #f6a;">Inlayo</span>
      </a>
      <a role="button" class="navbar-burger" id="navbar-burger" onclick="togglenavbar()">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div id="navbar-menu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/home" style="transition: all 0.2s ease;"> Home </a>
        
        <div class="navbar-item has-dropdown is-hoverable" style="position: relative;">
          <a class="navbar-link" style="transition: all 0.2s ease;"> Leaderboards </a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="/leaderboard">Performance</a>
            <a class="navbar-item" href="/leaderboard?sort=score">Score</a>
          </div>
        </div>
        
        <a class="navbar-item" href="/topplays" style="transition: all 0.2s ease;"> Top Plays </a>
        
        <div class="navbar-item has-dropdown is-hoverable" style="position: relative;">
          <a class="navbar-link" style="transition: all 0.2s ease;"> Community </a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="/discord" target="_blank">Discord</a>
            <a class="navbar-item" href="/github" target="_blank">GitHub</a>
            <a class="navbar-item" href="/twitter" target="_blank">Twitter</a>
            <a class="navbar-item" href="/youtube" target="_blank">YouTube</a>
            <a class="navbar-item" href="/twitch" target="_blank">Twitch</a>
          </div>
        </div>
      </div>

      <div class="navbar-end">
        <div class="navbar-item" style="padding: 0.5rem 0.75rem;">
          <div class="search-bar" style="display: flex; align-items: center; background: rgba(255, 255, 255, 0.05); border-radius: 4px; padding: 0.4rem 0.75rem;">
            <input id="search-txt" type="text" placeholder="Search players..." style="background: transparent; border: none; outline: none; color: #fff; font-size: 0.9rem; width: 180px;" />
            <button onclick="search()" style="background: transparent; border: none; cursor: pointer; color: rgba(255, 255, 255, 0.7); padding: 0; margin-left: 0.5rem;">
              <i class="fa-solid fa-magnifying-glass"></i>
            </button>
            <script src="/static/js/search.js"></script>
          </div>
          <div id="search-results" class="search-results"></div>
        </div>
        
        {% if session.authenticated %}
        <div class="navbar-item has-dropdown is-hoverable" style="position: relative;">
          <a class="navbar-link" style="display: flex; align-items: center; gap: 0.5rem; transition: all 0.2s ease;">
            <div class="navbar-avatar"
              style="background: url(https://a.{{ domain() }}/{{ session.user_data['id'] }}); background-size: cover; background-position: 50%; width: 32px; height: 32px; border-radius: 4px;">
            </div>
            <span>{{ session.user_data['name'] }}</span>
          </a>
          <div class="navbar-dropdown" style="right: 0; left: auto;">
            <a class="navbar-item" href="/u/{{ session.user_data['id'] }}">Profile</a>
            <a class="navbar-item" href="/settings">Settings</a>
            {% if session.authenticated and session.user_data['is_staff'] %}
            <a class="navbar-item" href="/admin">Management</a>
            {% endif %}
            <hr class="navbar-divider" style="background: rgba(255, 255, 255, 0.1); margin: 0.5rem 0;" />
            <a class="navbar-item" href="/logout">Logout</a>
          </div>
        </div>
        {% else %}
        <div class="navbar-item" style="padding: 0.5rem 1rem;">
          <div class="buttons" style="display: flex; gap: 0.5rem;">
            <a class="button is-primary" href="/register" style="padding: 0.5rem 1.25rem; font-size: 0.9rem; border-radius: 4px;">
              <strong>Sign up</strong>
            </a>
            <a class="button is-light" href="/login" style="padding: 0.5rem 1.25rem; font-size: 0.9rem; border-radius: 4px; background: rgba(255, 255, 255, 0.1); color: #fff; border: 1px solid rgba(255, 255, 255, 0.2);">Log in</a>
          </div>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</nav>

<style>
/* Hanayo-inspired navbar dropdown fix */
.navbar-item.has-dropdown {
  padding: 0;
}

.navbar-item.has-dropdown.is-hoverable {
  position: relative;
}

/* Ensure dropdown stays visible when hovering over it */
.navbar-item.has-dropdown.is-hoverable:hover .navbar-dropdown,
.navbar-item.has-dropdown.is-hoverable:focus-within .navbar-dropdown {
  display: block !important;
}

.navbar-dropdown {
  position: absolute;
  top: 100%;
  left: 0;
  margin-top: 0;
  padding: 4px 0;
  min-width: 180px;
  background: hsl(var(--base, 0), 0%, 12%);
  border: 1px solid rgba(255, 255, 255, 0.08);
  border-radius: 4px;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
  z-index: 9999;
}

.navbar-dropdown .navbar-item {
  padding: 0.65rem 1.25rem;
  font-size: 0.9rem;
  color: rgba(255, 255, 255, 0.8);
  white-space: nowrap;
}

.navbar-dropdown .navbar-item:hover {
  background: rgba(255, 255, 255, 0.08);
  color: #ffffff;
}

.navbar-link::after {
  border-color: rgba(255, 255, 255, 0.5);
}

.navbar-item:hover,
.navbar-link:hover {
  background: rgba(255, 255, 255, 0.05);
  color: #ffffff;
}

/* Search bar hover effect */
.search-bar:hover {
  background: rgba(255, 255, 255, 0.08) !important;
}

.search-bar button:hover {
  color: #fff !important;
}

/* Mobile responsiveness */
@media screen and (max-width: 1023px) {
  .navbar-menu {
    background-color: hsl(var(--base, 0), 0%, 12%);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
  }
  
  .navbar-dropdown {
    position: static;
    box-shadow: none;
    border: none;
    background: rgba(0, 0, 0, 0.2);
    padding-left: 1.5rem;
  }
}
</style>

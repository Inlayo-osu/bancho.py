<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"
  integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<nav id="navbar" class="navbar is-primary">
  <div class="container">
    <div class="navbar-brand">
      <a role="button" class="navbar-burger" id="navbar-burger" onclick="togglenavbar()">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div id="navbar-menu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/home"> Home </a>
        <a class="navbar-item" href="/leaderboard"> Leaderboards </a>
        <a class="navbar-item" href="/topplays"> Top Plays </a>
        <!-- <a class="navbar-item" href="/clansettings"> Clans </a> -->
        <!-- <a class="navbar-item" href="/rules"> Rules </a> -->
        <div class="navbar-item has-dropdown">
          <a class="navbar-link"> Informations </a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="/github" target="_blank">&nbsp;GitHub&nbsp;</a>
            <a class="navbar-item" href="/discord" target="_blank">&nbsp;Discord&nbsp;</a>
            <hr class="navbar-divider" />
            <a class="navbar-item" href="/howtoconnect">&nbsp;How to Connect&nbsp;</a>
          </div>
        </div>
        <!-- {% if session.authenticated %}
        <div class="navbar-item has-dropdown">
          <a class="navbar-link"> Clans </a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="/clans">&nbsp;Clan Leaderboard&nbsp;</a>
            {% if session.clan_data["id"] %}
            <a class="navbar-item" href="/settings/clansettings">&nbsp;Clan Settings&nbsp;</a>
            {% else %}
            <a class="navbar-item" href="/clans/create">&nbsp;Create Clan&nbsp;</a>
            {% endif %}
          </div>
        </div>
        {% endif %} -->
      </div>
    </div>

    <div class="navbar-end">
      <div class="navbar-item">
        <div class="search-bar">
          <input id="search-txt" type="text" placeholder="Search" />
          <button onclick="search()">
            <i class="fa-solid fa-magnifying-glass"></i>
          </button>
          <script src="/static/js/search.js"></script>
        </div>
        <div id="search-results" class="search-results"></div>
      </div>
      {% if session.authenticated %}
      <div class="navbar-item has-dropdown" style="zoom: 1.1">
        <a class="navbar-link">
          <div class="navbar-avatar"
            style="background: url(https://a.{{ domain() }}/{{ session.user_data['id'] }}); background-size: cover; background-position: 50%;">
          </div>
          {{ session.user_data['name'] }}
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="/u/{{ session.user_data['id'] }}">
            &nbsp;Profile&nbsp;
          </a>
          <a class="navbar-item" href="/settings"> &nbsp;Settings&nbsp;</a>
          {% if session.authenticated and session.user_data['is_staff'] %}
          <a class="navbar-item" href="/admin"> &nbsp;Management&nbsp;</a>
          {% endif %}
          <hr class="navbar-divider" />
          <a class="navbar-item" href="/logout"> &nbsp;Logout&nbsp;</a>
        </div>
      </div>
      {% else %}
      <div class="navbar-item" style="zoom: 1.1">
        <div class="buttons">
          <a class="button is-primary" href="/register">
            <strong>Sign up</strong>
          </a>
          <a class="button is-light" href="/login"> Log in </a>
        </div>
      </div>
      {% endif %}
    </div>
  </div>
</nav>

<style>
  /* Simple and clean navbar design */
  #navbar {
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    border-bottom: 1px solid rgba(255,255,255,0.1);
  }
  
  .navbar-item, .navbar-link {
    transition: none !important;
    animation: none !important;
    border-radius: 0;
  }
  
  .navbar-item:hover, .navbar-link:hover {
    transform: none !important;
    background-color: rgba(255,255,255,0.1);
  }
  
  .navbar-dropdown {
    transition: none !important;
    animation: none !important;
    border: none;
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    border-radius: 4px;
    padding: 0.5rem 0;
  }
  
  .navbar-dropdown .navbar-item {
    padding: 0.5rem 1.5rem;
  }
  
  .navbar-dropdown .navbar-item:hover {
    background-color: rgba(102, 126, 234, 0.1);
  }
  
  .navbar-divider {
    margin: 0.5rem 0;
    background-color: rgba(0,0,0,0.1);
  }
  
  .search-bar {
    background: rgba(255,255,255,0.15);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 4px;
    padding: 0.4rem 0.8rem;
  }
  
  .search-bar input {
    background: transparent;
    border: none;
    color: white;
    outline: none;
  }
  
  .search-bar input::placeholder {
    color: rgba(255,255,255,0.6);
  }
  
  .search-bar button {
    background: transparent;
    border: none;
    color: white;
    cursor: pointer;
    padding: 0 0.5rem;
  }
  
  .navbar-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    margin-right: 0.5rem;
  }
  
  .buttons .button {
    border-radius: 4px;
  }
</style>

<script>
  // Click-only dropdown toggle
  document.addEventListener('DOMContentLoaded', () => {
    const dropdowns = document.querySelectorAll('.navbar-item.has-dropdown');
    
    dropdowns.forEach(dropdown => {
      const link = dropdown.querySelector('.navbar-link');
      
      // Only respond to clicks, not hover
      link.addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation();
        
        // Close other dropdowns
        dropdowns.forEach(other => {
          if (other !== dropdown) {
            other.classList.remove('is-active');
          }
        });
        
        // Toggle current dropdown
        dropdown.classList.toggle('is-active');
      });
    });
    
    // Close dropdowns when clicking outside
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.navbar-item.has-dropdown')) {
        dropdowns.forEach(dropdown => {
          dropdown.classList.remove('is-active');
        });
      }
    });
  });
</script>

{% extends 'base.html' %}
{% block title %}Clan Leaderboard{% endblock %}

{% block description %}Clan Leaderboards on Inlayo{% endblock %}

{% block og_title %}Clan Leaderboard | Inlayo{% endblock %}
{% block og_description %}Compete with your clan and climb the clan rankings on Inlayo{% endblock %}
{% block og_image %}https://{{ domain() }}/static/favicon/android-chrome-256x256.png{% endblock %}

{% block header %}
<script src="/static/js/asserts/vue.js"></script>
<script src="/static/js/asserts/vue-axios.js"></script>

<script>
  var mode = "{{ mode }}";
  var mods = "{{ mods }}";
  var sort = "{{ sort }}";
  var domain = "{{ domain() }}";
  var page = parseInt("{{ page }}");
</script>

<link rel="stylesheet" href="/static/css/pages/leaderboard.css" />
{% endblock %} {% block content %}
<div id="app" :class="(load ? 'load' : '')" style="zoom: 1.1">
  <div class="leaderboard-banner main-banner">
    <div class="main-selector">
      <a class="mode-select" v-bind:class="{ 'active': mode === 'std' }" @click="LoadLeaderboard(sort, 'std', mods)">
        <i class="mode-icon mode-osu"></i><span class="modetext"> osu!</span>
      </a>
      <a class="mode-select" v-bind:class="{ 'active': mode === 'taiko', 'disabled': mods === 'ap' }"
        @click="LoadLeaderboard(sort, 'taiko', mods)">
        <i class="mode-icon mode-taiko"></i><span class="modetext"> osu!taiko</span>
      </a>
      <a class="mode-select" v-bind:class="{ 'active': mode === 'catch', 'disabled': mods === 'ap' }"
        @click="LoadLeaderboard(sort, 'catch', mods)">
        <i class="mode-icon mode-catch"></i><span class="modetext"> osu!catch</span>
      </a>
      <a class="mode-select" v-bind:class="{ 'active': mode === 'mania', 'disabled': mods === 'ap' || mods === 'rx' }"
        @click="LoadLeaderboard(sort, 'mania', mods)">
        <i class="mode-icon mode-mania"></i><span class="modetext"> osu!mania</span>
      </a>
    </div>
    <div class="banner-text">Clan Leaderboard</div>
    <div class="selector">
      <div class="left">
        <a class="simple-banner-switch" v-bind:class="{ 'active': sort === 'pp' }"
          @click="LoadLeaderboard('pp', mode, mods)">PP</a>
        <a class="simple-banner-switch" v-bind:class="{ 'active': sort === 'score' }"
          @click="LoadLeaderboard('score', mode, mods)">Score</a>
      </div>
      <div class="right">
        <a class="simple-banner-switch" v-bind:class=" { 'active': mods === 'vn' }"
          @click="LoadLeaderboard(sort, mode, 'vn')">Vanilla</a>
        <a class="simple-banner-switch" v-bind:class=" { 'active': mods === 'rx', 'disabled': mode === 'mania' }"
          @click="LoadLeaderboard(sort, mode, 'rx')">Relax</a>
        <a class="simple-banner-switch"
          v-bind:class=" { 'active': mods === 'ap', 'disabled': mode === 'taiko' || mode === 'catch' || mode === 'mania'  }"
          @click="LoadLeaderboard(sort, mode, 'ap')">Autopilot</a>
      </div>
    </div>
  </div>
  <div class="main-block">
    <div class="leaderboard-main-bg table-responsive">
      <div v-if="boards.length != undefined && boards.length != 0">
        <table class="leaderboard-table table-responsive">
          <thead>
            <tr>
              <th class="t-heading"></th>
              <th class="t-heading t-heading--main">Clan Name</th>
              <th v-if="sort == 'pp' || sort == 'score'" class="t-heading table--selected">
                <% (sort=='pp' ? "Total PP" : "" ) %>
                  <% (sort=='score' ? "Total Score" : "" ) %>
              </th>
              <th class="t-heading">Avg Accuracy</th>
              <th class="t-heading">Total Plays</th>
              <th class="t-heading">Members</th>
            </tr>
          </thead>
          <tbody>
            <tr v-for="(clan, index) in boards" class="leaderboard-column">
              <td class="column-player-rank" v-bind:style="(page > 0) ? 'color: #fff !important' : ''">
                #<% (page * 50) + index + 1 %>
              </td>
              <td class="column-player-name text-left">
                <a :href="'/c/'+clan.id+'?mode='+mode+'&mods='+mods">
                  [<% clan.tag %>] <% clan.name %>
                </a>
              </td>
              <td v-if="sort == 'pp' || sort == 'score'">
                <% (sort=='pp' ? addCommas(Math.round(clan.total_pp))+'pp' : "" ) %>
                  <% (sort=='score' ? scoreFormat(clan.total_score) : "" ) %>
              </td>
              <td>
                <% clan.avg_acc.toFixed(2) %>%
              </td>
              <td>
                <% addCommas(clan.total_plays) %>
              </td>
              <td>
                <% clan.member_count %>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div v-else>
        <div class="text-center">there are no players to display!</div>
      </div>
      <div class="pager">
        <span class="pager-btn" v-bind:class="(page === 0) ? 'btn-disabled' : ''"
          @click="if (page > 0) LoadLeaderboard(sort, mode, mods, -1)">
          <span>
            <i class="fa-solid fa-chevron-left"></i>
          </span>
        </span>
        Page <% page + 1 %>
          <span class="pager-btn" v-bind:class="(page === (page + 1) || boards.length < 50) ? 'btn-disabled' : '3'"
            @click="if (boards.length == 50) LoadLeaderboard(sort, mode, mods, 1)">
            <span>
              <i class="fa-solid fa-chevron-right"></i>
            </span>
          </span>
      </div>
    </div>
  </div>
</div>

<script src="/static/js/asserts/vue-flags.js"></script>
<script src="/static/js/pages/clan_leaderboard.js"></script>
{% endblock %}
